const URL_BASE="http://localhost/gdagmcp",token=JSON.parse(localStorage.getItem("token"));let errores;async function iniciarApp(){errores=await traerErrores(),console.log(errores),dibujarErrores()}function alertas(){const t=document.querySelectorAll(".alert"),a=document.getElementById("alertas"),e=document.querySelector("#alertaTipo");t&&setTimeout(()=>{t.forEach((function(t){t.remove(),a&&(a.innerHTML=""),e&&(e.innerHTML="")}))},3e3)}function traerErrores(){return new Promise((t,a)=>{let e=[];$.ajax({data:{tipo:"errores"},url:URL_BASE+"/error/datos",type:"POST",headers:{token:token},dataType:"json"}).done(a=>{a.exit&&Swal.fire({icon:"warning",title:a.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==a.length&&t(e),$.each(a,(r,o)=>{e.push(o),a.length==r+1&&t(e)})}).fail(t=>{a(t)})})}async function dibujarErrores(){var t="";let a=await traerErrores();t+='<h1 class="text-black mb-4"><strong>Administrar Errores</strong></h1>',t+='<table class="table" style="min-width:900px" id="tablaError">',t+='<thead class="table-dark">',t+='<tr class="" style="text-transform:uppercase">',t+="<th>N°</th>",t+='<th class="">Table</th>',t+='<th class="">Controller</th>',t+='<th class="">Function</th>',t+='<th class="">Data</th>',t+='<th class="">Error</th>',t+='<th class="">Fecha</th>',t+='<th class="">Status</th>',t+="</tr>",t+="</thead>",t+='<tbody class="contenido" id="contenido">',a.forEach((a,e)=>{console.log("error",a),t+="<tr>",t+="<td>"+(parseInt(e)+1)+"</td>",t+="<td>"+a.tabla_error+"</td>",t+="<td>"+a.controller_error+"</td>",t+="<td>"+a.function_error+"()</td>",t+='<td><buttom class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModalError'+a.id+'"><i class="fa-solid fa-eye fa-xl"></></buttom></td>',t+='<td class="col-4">'+a.error+"</td>",t+="<td>"+a.created_at.split(" ")[0]+"</td>",t+="<td> Status</td>",t+="</tr>",t+='<div class="modal fade" id="exampleModalError'+a.id+'" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">',t+=' <div class="modal-dialog">',t+=' <div class="modal-content">',t+=' <div class="modal-header bg-black">',t+=' <h4 class="modal-title text-white" id="exampleModalLabel">Datos ingresados</h4>',t+='<button type="button" class="btn text-white" style="font-size:11px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',t+=" </div>",t+=' <div class="modal-body">',t+=" </div>",t+='<div class="modal-footer">',t+=' <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cerrar</button>',t+="</div>",t+="</div>",t+=" </div>",t+="</div>"}),t+="</tbody>",t+="</table>",document.getElementById("dibujar-js").innerHTML=t,$("#tablaError").DataTable({language:{url:URL_BASE+"/public/build/js/varios/DataTable_es_es.json"}})}document.addEventListener("DOMContentLoaded",iniciarApp());