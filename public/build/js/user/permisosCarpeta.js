const URL_BASE="http://localhost/gdagmcp",token=JSON.parse(localStorage.getItem("token")),CARPETA_BASE="/base";let secciones,roles,permisosDefault=[{id:2,status:!1,nombre:"Crear_Carpeta",type:"carpeta",descripcion:"Permiso para crear carpetas"},{id:3,status:!1,nombre:"Editar_Carpeta",type:"carpeta",descripcion:"Permiso para Editar,Mover,Eliminar la carpeta"},{id:4,status:!1,nombre:"Ver_Documentos",type:"documento",descripcion:"Permiso para visualizar el documento"},{id:5,status:!1,nombre:"Mover_Documentos",type:"documento",descripcion:"Permiso para mover de carpeta los documentos"},{id:6,status:!1,nombre:"Crear_Documento",type:"documento",descripcion:"Permiso para Crear un documento"},{id:7,status:!1,nombre:"Editar_Documento",type:"documento",descripcion:"Permiso para Editar la metadata del documento"},{id:8,status:!1,nombre:"Eliminar_Documento",type:"documento",descripcion:"Permiso para Eliminar el documento"},{id:9,status:!1,nombre:"Descargar_Documento",type:"documento",descripcion:"Permiso para Descargar los documentos"}];async function iniciarApp(){const e=window.location.search;dibujarCarpeta(new URLSearchParams(e).get("id"))}function alertas(){const e=document.querySelectorAll(".alert"),t=document.getElementById("alertas"),a=document.querySelector("#alertaTipo");e&&setTimeout(()=>{e.forEach((function(e){e.remove(),t&&(t.innerHTML=""),a&&(a.innerHTML="")}))},3e3)}function traerSeccion(e){return new Promise((t,a)=>{$.ajax({data:{tipo:"findCarpeta",id:e},url:URL_BASE+"/carpeta/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),t(e)}).fail(e=>{a(e)})})}function traerHistorial(e){return new Promise((t,a)=>{let i=[];$.ajax({data:{idSeccion:e,tipo:"historial"},url:URL_BASE+"/carpeta/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==e.length&&t(i),$.each(e,(a,s)=>{i.push(s),e.length==a+1&&t(i)})}).fail(e=>{a(e)})})}async function dibujarCarpeta(e){var t="";document.getElementById("contenedor-titulo").innerHTML="";let a=await traerSeccion(e),i=await traerHistorial(e);if(t+='<div class="d-flex justify-content-center padreAtras">',t+='<div class="d-flex justify-content-center hijoAtras">',t+='<a class=" btn btn-outline-danger '+(null==a?"noVisible":"")+' " onclick="dibujarAtras()"><i class="fa-solid fa-arrow-left-long fa-2x"></i> <span class="span-boton">Atrás</span></a>',t+="</div>",null==a?t+='<h1 class="text-black mb-3"><strong>Administrar Carpetas</strong></h1>':(t+='<div class="d-flex flex-column justify-content-center">',t+='<div class="d-flex justify-content-center align-items-center">',t+='<i class="fa-solid fa-folder-open fa-xl" style="margin-right:7px;font-size:35px;color:'+a.color+'"></i>',t+='<div class="d-flex justify-content-center align-items-center">',t+='<h1 class="text-black m-0 p-0"><strong>'+(a.seccion[0].toUpperCase()+a.seccion.substring(1))+"</strong></h1>",t+="</div>",t+='<div class="d-flex justify-content-center align-items-center mb-2" style="margin-left:5px">',t+='<button type="button" class="btn btn-outline-secondary dropdown-toggle py-0" data-bs-toggle="dropdown" style="width:25px;height:30px;border:none">',t+='<i class="fa-solid fa-ellipsis-vertical" style="font-size:25px"></i>',t+="</button>",t+='<ul class="dropdown-menu dropdown-menu-dark">',t+=' <li class="puntero"><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModalEditar'+a.id+'"><i class="fa-solid fa-pen-to-square" style="margin-right:7px"></i>Editar</a></li>',t+=' <li class="puntero"><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModalInfo'+a.id+'"><i class="fa-solid fa-circle-info" style="margin-right:7px"></i>Información</a></li>',t+='<li class="puntero"><a class="dropdown-item" onclick="deleteSeccion('+a.id+')"><i class="fa-solid fa-trash" style="margin-right:7px"></i>Eliminar</a></li>',t+="</ul>",t+="</div>",t+="</div>",a.descripcion.length>0?t+='<h3 class="text-black mt-3 mb-4">'+(a.descripcion[0].toUpperCase()+a.descripcion.substring(1))+"</h3>":t+='<h3 class="text-black mt-3 mb-4">'+a.descripcion+"</h3>",t+="</div>"),t+="</div>",t+='<div class="w-100 mt-2">',null!=a){let e=("/base"+a.path).split("/");e.shift();e.forEach(e=>{var a=e.replaceAll("_"," ");console.log("nombre",a),t+='<a class="" style="text-decoration:none!important;color:#969798"><strong>'+(a[0].toUpperCase()+a.substring(1))+"</strong></a> /  "})}t+="</div>",t+='<div class="contenedor-carpetas mt-3 mb-5 py-3 px-4" style="min-width:900px" id="contenedorCarpetas" >',t+="</div>",t+='<div class="modal fade" id="exampleModalEditar'+a.id+'" tabindex="-1" aria-labelledby="exampleModalLabel'+a.id+'" aria-hidden="true">',t+='<div class="modal-dialog">',t+='<div class="modal-content">',t+='  <div class="modal-header bg-black">',t+='   <h5 class="modal-title text-white">Editar</h5>',t+='<button type="button" class="btn text-white" style="font-size:11px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',t+="  </div>",t+='  <div class="modal-body" style="min-height:350px">',t+='<h3 class="text-black mt-2 mb-4">Edite <strong>'+a.seccion+"</strong></h3>",t+='<div class="mb-4 d-flex justify-content-between">',t+='<div class="d-flex flex-column" style="width:70%">',t+='<label  class="form-label"><strong>Nombre:</strong></label>',t+='<input type="text" class="form-control" id="seccion'+a.id+'" value="'+a.seccion+'">',t+="</div>",t+='<div class="d-flex flex-column" style="width:28%">',t+='<label class="form-label"><strong>Color:</strong></label>',t+='<input type="color" class="form-control  puntero" id="color'+a.id+'" value="'+a.color+'">',t+="</div>",t+="</div>",t+='<div class="mb-4">',t+='<label for="exampleFormControlInput1" class="form-label"><strong>Descripción:</strong></label>',""==a.descripcion?t+='<textarea class="form-control" rows="6" id="descripcion'+a.id+'" placeholder="Esta Sección no tiene descripción"></textarea>':t+='<textarea class="form-control" rows="6" id="descripcion'+a.id+'" >'+a.descripcion+"</textarea>",t+="</div>",t+='<div class="mb-4">',t+='<div class="w-100">',t+='<label class="form-label"><strong>Mover Carpeta:</strong></label>',t+="</div>",t+='<div style="height:30px">',t+='<select style="width:100%;height:100% !important" id="select'+a.id+'" class="js-example-basic-single" >';let s=JSON.parse(a.carpetas);s.unshift({id:"0",idPadre:"0",seccion:"CARPETA BASE",descripcion:"",color:"#000000",path:"/base"}),s.forEach(e=>{e.id!=a.id&&(t+='<optgroup label="'+e.seccion+'">',t+='<option value="'+e.id+'" '+(e.id==a.idPadre?"selected":"")+'><strong><i class="fa-solid fa-folder-open"></i></strong>'+e.path+"</option>",t+="</optgroup>")}),t+="</select>",t+="</div>",t+='<div class="w-100 mt-4" id="alertas'+a.id+'">',t+="</div>",t+="</div>",t+="</div>",t+='<div class="modal-footer">',t+='<button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancelar</button>',t+='<a class="btn btn-success" id="botonCrear" onclick="updateSeccion('+a.idPadre+","+a.id+',2)"><i class="fa-solid fa-floppy-disk"></i> <span style="margin-left:8px">Guardar</span></a>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",t+='<div class="w-100 mt-2" id="alertas">',t+="</div>",t+="</div>",t+='<div class="modal-footer">',t+='<button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cerrar</button>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",t+='<div class="modal fade" id="exampleModalInfo'+a.id+'" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" >',t+='<div class="modal-dialog modal-lg" style="min-width:800px !important" >',t+='<div class="modal-content">',t+='  <div class="modal-header bg-black">',t+='   <h5 class="modal-title text-white">Información de Carpeta</h5>',t+='<button type="button" class="btn text-white" style="font-size:11px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',t+="  </div>",t+='  <div class="modal-body">',0==a?t+='   <h5 class="modal-title text-white">Modificaciones</h5>':(t+='<div class="d-flex justify-content-between">',t+='<div style="width:160px"></div>',t+='<h3 class="text-black mt-2 mb-4"> <i class="fa-solid fa-folder-open" style="color:'+a.color+'"></i> '+(a.seccion[0].toUpperCase()+a.seccion.substring(1))+"</h3>",t+='<div><button type="button" class="btn btn-warning" style="font-size:13.4px" onclick="historialDocs('+a.id+')"><i class="fa-solid fa-rotate-right fa-flip-horizontal" style="margin-right:5px"></i>Historial Documentos</button></div>',t+="</div>"),t+='<div id="historialDoc">',t+='<table class="table table-hover align-middle" id="tablaHistorialCarpeta">',t+='<thead class="table-secondary ">',t+='<tr style="text-transform:uppercase">',t+="<th >#</th>",t+="<th >Usuario</th>",t+="<th >Acción</th>",t+='<th style="width:170px">Carpeta</th>',t+="<th >Fecha</th>",t+="<th  >Detalle</th>",t+="</tr>",t+="</thead>",t+='<tbody class="contenido" id="contenido">',i.forEach((e,a)=>{var i=null!=e.nombreSeccion?e.nombreSeccion:e.seccion;t+=`<tr title="${i[0].toUpperCase()+i.substring(1)}">`,t+=`<td >${a+1}</td>`,t+=`<td style="min-width:112px"> ${null!=e.nombre?e.nombre:e.user}</td>`,t+=`<td class="${"create"==e.accion?"text-success":"delete"==e.accion?"text-danger":"text-primary"}"> ${e.accion[0].toUpperCase()+e.accion.substring(1)}</td>`,t+=`<td >${i[0].toUpperCase()+i.substring(1)}</td>`,t+=`<td style="min-width:172px"> ${e.created_at}</td>`,t+='<td ">',t+='<div class="d-flex justify-content-center dropend">',t+='<button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown"  style="border-radius:15px;border:0px">',t+='<i class="fa-solid fa-ellipsis-vertical fa-2x"></i>',t+="</button>",t+=' <div class="dropdown-menu dropdown-menu-dark p-4" style="min-width:400px" >',t+='<div class="d-flex" style="font-size:13px">',t+='<div class="d-flex w-100 justify-content-center" style="font-size:13px"><i class="fa-solid fa-folder-open" style="margin-right:5px"></i> <strong>'+(i[0].toUpperCase()+i.substring(1))+"</strong>",t+="</div>",t+="</div>",t+='<div class="row" style="font-size:13px">';var s=JSON.parse(e.data);for(var o in s.new)t+='<div style="display:block;height:auto;">',t+='<div style="min-width:100px"><strong>'+(o[0].toUpperCase()+o.substring(1))+":</strong></div>",t+='<div > <span class="text-info">New </span> => '+(null!=s.new[o]?s.new[o]:"null")+"</div>",t+='<div > <span class="text-warning">Old </span> => '+(null!=s.old[o]?s.old[o]:"null")+"</div>",t+="</div>";t+="</div>",t+="</div>",t+="</td>",t+="</tr>"}),t+="</tbody>",t+="</table>",t+="</div>",t+='<div class="w-100 mt-2" id="alertas">',t+="</div>",t+="</div>",t+='<div class="modal-footer">',t+='<button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancelar</button>',t+="</div>",t+="</div>",t+="</div>",t+="</div>",document.getElementById("dibujar-js").innerHTML=t,document.getElementById("dibujar-tabla").innerHTML="",waitResponse("#contenedorCarpetas"),$("#select"+e).select2({dropdownParent:$("#exampleModalEditar"+e)}),$("#tablaHistorialCarpeta").DataTable({columnDefs:[{targets:[5],searchable:!1}],language:{url:URL_BASE+"/public/build/js/varios/DataTable_es_es.json"}}),await dibujarUsers("contenedorCarpetas",e)}async function waitResponse(e,t="129.5px",a=1){var i="";1==a?(i+='<div class="d-flex justify-content-center align-items-center w-100" style="width:100% !important;height:'+t+'" width:100% !important;height:50px" id="contenedorWait">',i+=' <div class="spinner-grow" role="status">',i+='<span class="visually-hidden">Loading...</span>',i+="</div>",i+=' <div class="spinner-grow" role="status">',i+='<span class="visually-hidden">Loading...</span>',i+="</div>",i+=' <div class="spinner-grow" role="status">',i+='<span class="visually-hidden">Loading...</span>',i+="</div>",i+="</div>"):(e.innerHTML="",i+='<td colspan="8" valign="top">',i+='<div class="d-flex justify-content-center align-items-center w-100" style="width:100% !important;height:'+t+'" id="contenedorWait">',i+=' <div class="spinner-grow" role="status">',i+='<span class="visually-hidden">Loading...</span>',i+="</div>",i+=' <div class="spinner-grow" role="status">',i+='<span class="visually-hidden">Loading...</span>',i+="</div>",i+=' <div class="spinner-grow" role="status">',i+='<span class="visually-hidden">Loading...</span>',i+="</div>",i+="</div>",i+="</td>"),document.querySelector(e).innerHTML=i}async function dibujarUsers(e,t,a=1,i=[]){0==i.length&&(i=await traerUsers());let s=combinarArrays(i,await traerUnidades());var o="";o+="<h4><strong>Usuarios</strong></h4>",o+='<table class="table" style="min-width:900px" id="tablaUsuariosPermisos">',o+='<thead class="table-dark">',o+='<tr class="" style="text-transform:uppercase">',o+="<th >N°</th>",o+="<th>Nombre</th>",o+="<th>Rol</th>",o+="<th>Unidad</th>",o+="<th>Estado</th>",o+="<th>Jefe</th>",o+="<th>Usuarios</th>",o+='<th class="col-1">Acciones</th>',o+="</tr>",o+="</thead>",o+='<tbody class="contenido" id="contenido">',s.forEach((e,i)=>{let s="1"==e.estado?"btn-outline-success":"btn-outline-danger";o+='<tr class="">',o+="<td>"+(parseInt(i)+1)+"</td>",o+='<td class="col">',o+='<div class="d-flex justify-content-between">',o+='<div class="" style="min-width:180px">',o+=`<i class="fa-solid ${"-"!=e.idUser?"fa-user":"fa-building"}" style="margin-right:6px"></i>`,o+=`<span>${e.nombre}</span>`,o+="</div>","-"!=e.idUser&&(o+='<div class="d-flex justify-content-start w-100" >',o+='<button type="button" class="btn btn-outline-secondary" style="border-radius:15px;border:0px" onclick="dibujarHistorialUser('+t+","+e.idUser+')">',o+='<i class="fa-solid fa-ellipsis-vertical fa-xl"></i>',o+="</button>",o+="</div>"),o+="</div>",o+="</div>",o+="</td>",o+='<td class="col">'+e.rol+"</td>",o+='<td class="col">'+e.unidad+"</td>","-"!=e.estado?o+='<td class="col"><buttom type="buttom" disabled class="botonDisabled btn btn-rounded '+s+'"  style="">'+("1"==e.estado?"Activo":"Inactivo")+"</buttom></td>":o+='<td class="col">'+e.estado+"</td>",o+='<td class="col">'+e.jefe+"</td>",o+='<td class="col">'+e.usuarios+"</td>",o+='<td class="col">',o+='<div class="d-flex">';let l="-"!=e.idUnidad?1:0,d="-"!=e.idUnidad?e.idUnidad:e.idUser;o+=`<a class="btn btn-primary  botonPermiso" id="${a}" onclick="modalPermiso('${t}','${d}',${l})" style="margin:0px 5px">Permisos</a>`,o+="<div>",o+="</td>",o+="</tr>"}),o+="</tbody>",o+="</table>",document.getElementById(e.toString()).classList.add("mt-5"),document.getElementById(e.toString()).innerHTML=o,$("#tablaUsuariosPermisos").DataTable({language:{url:URL_BASE+"/public/build/js/varios/DataTable_es_es.json"}})}async function dibujarHistorialUser(e,t){let a,i=await findUserById(t);a=await traerPermisosUser(e,i.id),0==a.length&&(a=await traerPermisosUnidad(e,i.idUnidad)),console.log("permisos User",a)}async function dibujarModalHistorialDoc(e){var t="";let a=await traerDocumento(e),i=await traerHistorialDoc(e);t+='<div class="modal fade" id="exampleModalHistorialByDoc'+a.id+'" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">',t+=' <div class="modal-dialog modal-lg">',t+=' <div class="modal-content">',t+=' <div class="modal-header bg-black ">',t+=' <h5 class="modal-title text-white" id="exampleModalLabel">Historial Documento <strong>'+a.codigo+"</strong></h5>",t+='<button type="button" class="btn text-white" style="font-size:13px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',t+=" </div>",t+='  <div class="modal-body">',t+='<h3 class="text-black mt-2 mb-4"> <i class="fa-solid fa-file-pdf" "></i> '+(""!=a.alias?a.alias:a.codigo)+"</h3>",t+='<div id="historialDoc">',t+='<table class="table table-hover align-middle" id="tablaHistorialByDoc">',t+='<thead class="table-secondary ">',t+='<tr style="text-transform:uppercase">',t+="<th >#</th>",t+="<th >Usuario</th>",t+="<th >Acción</th>",t+='<th style="width:170px">Carpeta</th>',t+="<th >Fecha</th>",t+="<th  >Detalle</th>",t+="</tr>",t+="</thead>",t+='<tbody class="contenido" id="contenido">',i.forEach((e,a)=>{console.log("dato",e);var i=null!=e.nombreSeccion?e.nombreSeccion:e.seccion;t+=`<tr title="${i[0].toUpperCase()+i.substring(1)}">`,t+=`<td >${a+1}</td>`,t+=`<td style="min-width:112px"> ${null!=e.nombre?e.nombre:e.user}</td>`,t+=`<td class="${"create"==e.accion?"text-success":"delete"==e.accion?"text-danger":"text-primary"}"> ${e.accion[0].toUpperCase()+e.accion.substring(1)}</td>`,t+=`<td >${i[0].toUpperCase()+i.substring(1)}</td>`,t+=`<td style="min-width:172px"> ${e.created_at}</td>`,t+='<td ">',t+='<div class="d-flex justify-content-center dropend">',t+='<button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown"  style="border-radius:15px;border:0px">',t+='<i class="fa-solid fa-ellipsis-vertical fa-2x"></i>',t+="</button>",t+=' <div class="dropdown-menu dropdown-menu-dark p-4" style="min-width:400px" >',t+='<div class="d-flex" style="font-size:13px">',t+='<div class="d-flex w-100 justify-content-center" style="font-size:13px"><i class="fa-solid fa-file-pdf" style="margin-right:5px"></i> <strong>'+e.documento+"</strong>",t+="</div>",t+="</div>",t+='<div class="row" style="font-size:13px">';var s=JSON.parse(e.data);for(var o in s.new){if(t+='<div style="display:block;height:auto;">',t+='<div style="min-width:100px"><strong>'+(o[0].toUpperCase()+o.substring(1))+":</strong></div>","data"!=o)t+='<div > <span class="text-info">New </span> => '+(null!=s.new[o]?s.new[o]:"null")+"</div>",null!=s.old&&(t+='<div > <span class="text-warning">Old </span> => '+(null!=s.old[o]?s.old[o]:"null")+"</div>");else{var l=JSON.parse(s.new.data);if(t+='<div style="display:block;height:auto;">',null!==s.old)for(let e=0;e<l.length;e++){var d=JSON.parse(s.old.data);t+='<div> <span class="text-info">New => </span>'+(null!=l[e].nombre?l[e].nombre:"null")+"  => "+(null!=l[e].valor?l[e].valor:"null")+"</div>",t+='<div> <span class="text-warning">Old =></span> '+(null!=d[e].nombre?d[e].nombre:"null")+" => "+(null!=d[e].valor?d[e].valor:"null")+"</div>"}else for(let e=0;e<l.length;e++)t+='<div> <span class="text-info">New => </span>'+(null!=l[e].nombre?l[e].nombre:"null")+"  => "+(null!=l[e].valor?l[e].valor:"null")+"</div>";t+="</div>"}t+="</div>"}t+="</div>",t+="</div>",t+="</td>",t+="</tr>"}),t+="</tbody>",t+="</table>",t+="</div>",t+="<div>",t+="</div>",t+=' <div class="modal-footer mt-3">',t+=' <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cerrar</button>',t+="  </div>",t+="</div>",t+="</div>",t+="</div>",document.getElementById("modales").innerHTML=t,$("#tablaHistorialByDoc").DataTable({columnDefs:[{targets:[5],searchable:!1}],language:{url:URL_BASE+"/public/build/js/varios/DataTable_es_es.json"}}),$("#exampleModalHistorialByDoc"+a.id).modal("show")}async function historialDocs(e){var t="";await waitResponse("#historialDoc","374.5px",2);let a=await traerHistorialDocCarpeta(e);t+='<h3 class="text-black mt-2 mb-4"><strong>HISTORIAL DOCUMENTOS</strong></h3>',t+='<table class="table table-hover align-middle" id="tablaHistorialDocs">',t+='<thead class="table-secondary">',t+='<tr style="text-transform:uppercase">',t+="<th >#</th>",t+="<th >Usuario</th>",t+="<th >Acción</th>",t+='<th style="width:170px">Documento</th>',t+="<th >Fecha</th>",t+="<th  >Detalle</th>",t+="</tr>",t+="</thead>",t+='<tbody class="contenido" id="contenido">',a.forEach((e,a)=>{console.log("dato",e);var i=null!=e.nombreSeccion?e.nombreSeccion:e.seccion;t+=`<tr title="${i[0].toUpperCase()+i.substring(1)}">`,t+=`<td >${a+1}</td>`,t+=`<td style="min-width:112px"> ${null!=e.nombre?e.nombre:e.user}</td>`,t+=`<td class="${"create"==e.accion?"text-success":"delete"==e.accion?"text-danger":"text-primary"}"> ${e.accion[0].toUpperCase()+e.accion.substring(1)}</td>`,t+=`<td >${e.documento}</td>`,t+=`<td style="min-width:172px"> ${e.created_at}</td>`,t+='<td ">',t+='<div class="d-flex justify-content-center dropend">',t+='<button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown"  style="border-radius:15px;border:0px">',t+='<i class="fa-solid fa-ellipsis-vertical fa-2x"></i>',t+="</button>",t+=' <div class="dropdown-menu dropdown-menu-dark p-4" style="min-width:400px" >',t+='<div class="d-flex" style="font-size:13px">',t+='<div class="d-flex w-100 justify-content-center" style="font-size:13px"><i class="fa-solid fa-file-pdf" style="margin-right:5px"></i> <strong>'+e.documento+"</strong>",t+="</div>",t+="</div>",t+='<div class="row" style="font-size:13px">';var s=JSON.parse(e.data);for(var o in s.new){if(t+='<div style="display:block;height:auto;">',t+='<div style="min-width:100px"><strong>'+(o[0].toUpperCase()+o.substring(1))+":</strong></div>","data"!=o)t+='<div > <span class="text-info">New </span> => '+(null!=s.new[o]?s.new[o]:"null")+"</div>",null!=s.old&&(t+='<div > <span class="text-warning">Old </span> => '+(null!=s.old[o]?s.old[o]:"null")+"</div>");else{var l=JSON.parse(s.new.data);if(t+='<div style="display:block;height:auto;">',null!==s.old)for(let e=0;e<l.length;e++){var d=JSON.parse(s.old.data);t+='<div> <span class="text-info">New => </span>'+(null!=l[e].nombre?l[e].nombre:"null")+"  => "+(null!=l[e].valor?l[e].valor:"null")+"</div>",t+='<div> <span class="text-warning">Old =></span> '+(null!=d[e].nombre?d[e].nombre:"null")+" => "+(null!=d[e].valor?d[e].valor:"null")+"</div>"}else for(let e=0;e<l.length;e++)t+='<div> <span class="text-info">New => </span>'+(null!=l[e].nombre?l[e].nombre:"null")+"  => "+(null!=l[e].valor?l[e].valor:"null")+"</div>";t+="</div>"}t+="</div>"}t+="</div>",t+="</div>",t+="</td>",t+="</tr>"}),t+="</tbody>",t+="</table>",document.getElementById("historialDoc").innerHTML=t,$("#tablaHistorialDocs").DataTable({columnDefs:[{targets:[5],searchable:!1}],language:{url:URL_BASE+"/public/build/js/varios/DataTable_es_es.json"}})}function traerHistorialDocCarpeta(e){return new Promise((t,a)=>{let i=[];$.ajax({data:{idSeccion:e,tipo:"historial"},url:URL_BASE+"/documento/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==e.length&&t(i),$.each(e,(a,s)=>{i.push(s),e.length==a+1&&t(i)})}).fail(e=>{a(e)})})}function traerHistorialDoc(e){return new Promise((t,a)=>{let i=[];$.ajax({data:{idDoc:e,tipo:"historialByDoc"},url:URL_BASE+"/documento/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==e.length&&t(i),$.each(e,(a,s)=>{i.push(s),e.length==a+1&&t(i)})}).fail(e=>{a(e)})})}function traerUsers(){return new Promise((e,t)=>{let a=[];$.ajax({data:{tipo:"usuarios"},url:URL_BASE+"/user/datos",type:"POST",headers:{token:token},dataType:"json"}).done(t=>{t.exit&&Swal.fire({icon:"warning",title:t.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==t.length&&e(a),$.each(t,(i,s)=>{a.push(s),t.length==i+1&&e(a)})}).fail(e=>{t(e)})})}function traerUnidades(){return new Promise((e,t)=>{let a=[];$.ajax({data:{tipo:"unidadSeccion"},url:URL_BASE+"/unidad/datos",type:"POST",headers:{token:token},dataType:"json"}).done(t=>{t.exit&&Swal.fire({icon:"warning",title:t.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==t.length&&e(a),$.each(t,(i,s)=>{a.push(s),t.length==i+1&&e(a)})}).fail(e=>{t(e)})})}function combinarArrays(e,t){for(var a=[],i=0;i<e.length;i++){var s=e[i],o={numero:i+1,nombre:s.nombre,rol:s.rol,unidad:s.unidad,estado:s.estado,jefe:"-",usuarios:"-",acciones:s.acciones,idUser:s.id,idUnidad:"-"};a.push(o)}for(i=0;i<t.length;i++){var l=t[i];o={numero:i+e.length+1,nombre:l.unidad,rol:"-",unidad:"-",estado:"-",jefe:l.jefe,usuarios:l.usuarios,acciones:"-",idUnidad:l.id,idUser:"-"};a.push(o)}return a}function mutarDato(e){return{nombre:void 0!==e.nombre?e.nombre:void 0!==e.unidad?e.unidad:"",rol:void 0!==e.rol?e.rol:"",unidad:void 0!==e.unidad?e.unidad:"",estado:void 0!==e.estado?e.estado:"",jefe:void 0!==e.jefe?e.jefe:"",usuarios:void 0!==e.usuarios?e.usuarios:"",id:e.id}}async function dibujarAtras(){window.location.href=URL_BASE+"/permisos"}function traerPermisosUser(e,t){return new Promise((a,i)=>{$.ajax({data:{tipo:"permisosUserCarpeta",idUser:t,idSeccion:e},url:URL_BASE+"/user/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),a(e)}).fail(e=>{i(e)})})}function traerPermisosUnidad(e,t){return new Promise((a,i)=>{$.ajax({data:{tipo:"permisosUnidadCarpeta",idUnidad:t,idSeccion:e},url:URL_BASE+"/unidad/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),a(e)}).fail(e=>{i(e)})})}function findUserById(e){return new Promise((t,a)=>{$.ajax({data:{id:e,tipo:"usuario"},url:URL_BASE+"/user/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),t(e)}).fail(e=>{a(e)})})}function findUnidadById(e){return new Promise((t,a)=>{$.ajax({data:{id:e,tipo:"unidad"},url:URL_BASE+"/unidad/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),t(e)}).fail(e=>{a(e)})})}async function modalPermiso(e,t,a){let i;if(0==a){i=await traerPermisosUser(e,t);let a=await findUserById(t);0==i.length&&(i=await traerPermisosUnidad(e,a.idUnidad))}else 1==a&&(i=await traerPermisosUnidad(e,t));0==i.length?crearModalAgregarPermisos(e,t,a):crearModalEditarPermisos(e,t,a)}async function crearModalAgregarPermisos(e,t,a){0==a&&(t=await findUserById(t)),1==a&&(t=await findUnidadById(t)),t=mutarDato(t);let i=["fa-solid fa-plus","fa-solid fa-edit","fa-solid fa-eye","fa-solid fa-folder-tree","fa-solid fa-plus","fa-solid fa-edit","fa-solid fa-trash","fa-solid fa-download"];var s="";s+='<div class="modal fade" id="exampleModalPermisosUser" tabindex="-1" aria-labelledby="exampleModalPermisosUser" aria-hidden="true">',s+='<div class="modal-dialog">',s+='<div class="modal-content">',s+='<div class="modal-header bg-black">',s+='<h5 class="modal-title text-white">Agregar Permisos</h5>',s+='<button type="button" class="btn text-white" style="font-size:11px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',s+="</div>",s+='<div class="modal-body">',s+='<h3 class="text-black"><strong>'+t.nombre.toUpperCase()+"</strong></h3>",s+='<h5 class="text-black mt-4 mb-1">Permisos de Carpeta <i class="fa-solid fa-folder-open fa-lg" style="margin-left:5px"></i></h5>',s+='<div class="unido_alerta">',s+='<div class="mb-2" style="border:1px solid #bcbcbc;border-radius:5px">',s+='<div class="row p-3">',s+='<div  class="d-flex justify-content-between w-100">',s+='<div class="d-flex " >',s+='<div  style="width:160px" >',s+='<i class="fa-solid fa-eye fa-xl" style="margin-right:5px"></i>',s+="<label>Ver Carpeta</label>",s+="</div>",s+='<input class="form-check-input permiso" id="1" type="checkbox">',s+="</div>",s+='<div class="d-flex" >',s+='<div  style="width:160px" >',s+='<i class="fa-solid fa-right-left fa-xl" style="margin-right:5px"></i>',s+="<label>Heredar Permisos</label>",s+="</div>",s+='<input class="form-check-input" id="heredar" type="checkbox">',s+="</div>",s+="</div>",permisosDefault.forEach((e,t)=>{"carpeta"==e.type&&(s+='<div class="d-flex '+(1!=e.id?"apagar":"")+'" >',s+='<div  style="width:160px" >',s+=`<i class="${i[t]} fa-xl" style="margin-right:5px"></i>`,s+="<label>"+e.nombre.replaceAll("_"," ")+"</label>",s+="</div>",s+='<input class="form-check-input permiso" id="'+e.id+'" type="checkbox">',s+="</div>")}),s+="</div>",s+="</div>",s+="</div>",s+='<h5 class="text-black mt-4 mb-1">Permisos de Documento<i class="fa-solid fa-file-pdf fa-lg" style="margin-left:5px"></i></h5>',s+='<div class="unido_alerta">',s+='<div class="mb-2" style="border:1px solid #bcbcbc;border-radius:5px">',s+='<div class="row p-3">',permisosDefault.forEach((e,t)=>{"documento"==e.type&&(s+='<div class="d-flex '+(4!=e.id?"apagar":"")+'">',s+='<div  style="width:160px">',s+=`<i class="${i[t]} fa-xl" style="margin-right:5px"></i>`,s+="<label>"+e.nombre.replaceAll("_"," ")+"</label>",s+="</div>",s+='<input class="form-check-input permiso" id="'+e.id+'"  type="checkbox">',s+="</div>")}),s+="</div>",s+="</div>",s+="</div>",s+='<div class="w-100"  id="alertasPermisosUser">',s+="</div>",s+="</div>",s+='<div class="modal-footer mt-2 d-flex justify-content-end">',s+='<button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cerrar</button>',s+=`<button type="button" class="btn btn-success" onclick="savePermisos(${e},${t.id},${a},0)"><i class="fa-solid fa-floppy-disk" style="margin-right:3px"></i>Guardar</button>`,s+="</div>",s+="</div>",document.getElementById("modales").innerHTML=s,$("#selectMover").select2({dropdownParent:$("#exampleModalPermisosUser")}),$("#exampleModalPermisosUser").modal("show")}async function crearModalEditarPermisos(e,t,a){let i,s=!1,o=1;0==a&&(t=await findUserById(t),i=await traerPermisosUser(e,t.id),0==i.length&&(s=!0,i=await traerPermisosUnidad(e,t.idUnidad),o=0)),1==a&&(t=await findUnidadById(t),i=await traerPermisosUnidad(e,t.id)),t=mutarDato(t);let l=JSON.parse(i[0].permisos);console.log("permisos",i);let d=["fa-solid fa-plus","fa-solid fa-edit","fa-solid fa-eye","fa-solid fa-folder-tree","fa-solid fa-plus","fa-solid fa-edit","fa-solid fa-trash","fa-solid fa-download"];var n="";n+='<div class="modal fade" id="exampleModalPermisosUser" tabindex="-1" aria-labelledby="exampleModalPermisosUser" aria-hidden="true">',n+='<div class="modal-dialog">',n+='<div class="modal-content">',n+='<div class="modal-header bg-black">',n+='<h5 class="modal-title text-white">Editar Permisos</h5>',n+='<button type="button" class="btn text-white" style="font-size:11px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',n+="</div>",n+='<div class="modal-body">',n+='<h3 class="text-black"><strong>'+t.nombre.toUpperCase()+"</strong></h3>",n+='<h5 class="text-black mt-4 mb-1">Permisos de Carpeta <i class="fa-solid fa-folder-open fa-lg" style="margin-left:5px"></i></h5>',n+='<div class="unido_alerta">',n+='<div class="mb-2" style="border:1px solid #bcbcbc;border-radius:5px">',n+='<div class="row p-3">',n+='<div  class="d-flex justify-content-between w-100">',n+='<div class="d-flex " >',n+='<div  style="width:160px" >',n+='<i class="fa-solid fa-eye fa-xl" style="margin-right:5px"></i>',n+="<label>Ver Carpeta</label>",n+="</div>",n+='<input class="form-check-input permiso" id="1" type="checkbox"'+(1==i[0].verSeccion?"checked":"")+">",n+="</div>",n+='<div class="d-flex" >',n+='<div  style="width:160px" >',n+='<i class="fa-solid fa-right-left fa-xl" style="margin-right:5px"></i>',n+="<label>Heredar Permisos</label>",n+="</div>",n+='<input class="form-check-input" id="heredar" type="checkbox">',n+="</div>",n+="</div>",l.forEach((e,t)=>{"carpeta"==e.type&&(n+='<div class="d-flex" >',n+='<div  style="width:160px" >',n+=`<i class="${d[t]} fa-xl" style="margin-right:5px"></i>`,n+="<label>"+e.nombre.replaceAll("_"," ")+"</label>",n+="</div>",n+='<input class="form-check-input permiso" id="'+e.id+'" type="checkbox" '+(1==e.status?"checked":"")+">",n+="</div>")}),n+="</div>",n+="</div>",n+="</div>",n+='<h5 class="text-black mt-4 mb-1">Permisos de Documento<i class="fa-solid fa-file-pdf fa-lg" style="margin-left:5px"></i></h5>',n+='<div class="unido_alerta">',n+='<div class="mb-2" style="border:1px solid #bcbcbc;border-radius:5px">',n+='<div class="row p-3">',l.forEach((e,t)=>{"documento"==e.type&&(n+='<div class="d-flex ">',n+='<div  style="width:160px">',n+=`<i class="${d[t]} fa-xl" style="margin-right:5px"></i>`,n+="<label>"+e.nombre.replaceAll("_"," ")+"</label>",n+="</div>",n+='<input class="form-check-input permiso" id="'+e.id+'"  type="checkbox" '+(1==e.status?"checked":"")+">",n+="</div>")}),n+="</div>",n+="</div>",n+="</div>",n+='<div class="w-100"  id="alertasPermisosUser">',n+="</div>",n+="</div>",n+='<div class="modal-footer mt-2 d-flex justify-content-between">',1==s?n+=`<div class="form-text">* Permisos Heredados de la Unidad <strong>${t.unidad}</strong></div>`:(n+="<div>",console.log("datooo",t),n+=`<button type="button" class="btn btn-primary" onclick="heredarUnidad(${t.id},${e})">Heredar de <strong>Unidad</strong></button>`,n+="</div>"),n+="<div>",n+='<button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cerrar</button>',n+=`<button type="button" class="btn btn-success" style="margin-left:5px" onclick="savePermisos(${e},${t.id},${a},${o})"><i class="fa-solid fa-floppy-disk" style="margin-right:3px"></i>Guardar</button>`,n+="</div>",n+="</div>",n+="</div>",document.getElementById("modales").innerHTML=n,$("#selectMover").select2({dropdownParent:$("#exampleModalPermisosUser")}),$("#exampleModalPermisosUser").modal("show")}document.addEventListener("DOMContentLoaded",iniciarApp());let cont=0;async function heredarUnidad(e,t){$.ajax({data:{idUser:e},url:URL_BASE+"/permisos/heredar",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{console.log(e),e.exito?Swal.fire({position:"top-end",icon:"success",title:e.exito,showConfirmButton:!1,timer:1500}).then(()=>{$("#exampleModalPermisosUser").modal("hide"),dibujarCarpeta(t)}):e.error?Swal.fire({icon:"error",title:"ERROR",text:e.error}).then(()=>{$("#exampleModalPermisosUser").modal("hide"),dibujarCarpeta(t)}):e.exit?Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}):(html+='<ul class="alert bg-white px-5 mt-3" style="border-radius:5px;border:1px solid red"  style="width:100%" >',e.alertas.error.forEach(e=>{html+='<li class="text-danger"  >',html+=e,html+="</li>"}),html+="</ul>",document.getElementById("alertas").innerHTML=html),alertas()})}async function savePermisos(e,t,a,i){console.log("tipo",a);let s=document.getElementById("heredar").checked,o=document.querySelectorAll(".permiso");o=Array.apply(null,o);let l=0;var d="";let n=o.filter(e=>e.checked).map(e=>e.id),r=document.querySelector("input[id='1']").checked;console.log("verSeccion",r);let c=permisosDefault.filter(e=>1!==e.id).map(e=>({...e,status:!!n.includes(e.id.toString())||e.status}));if(0==r&&o.forEach(e=>{e.id>3&&1==e.checked&&l++}),0!=l)return d+='<ul class="alert bg-white px-5 mt-3" style="border-radius:5px;border:1px solid red"  style="width:100%" >',d+='<li class="text-danger">',d+="Ver Carpeta debe activarse para dar permisos a los Documentos",d+="</li>",document.getElementById("alertasPermisosUser").innerHTML=d,void alertas();const p=new FormData;let u;p.append("idSeccion",e),p.append("verSeccion",r),p.append("heredar",s),p.append("accion",i),0==a?p.append("idUser",t):1==a&&p.append("idUnidad",t),p.append("permisos",JSON.stringify(c)),console.log([...p]),0==a?u=URL_BASE+"/permisos/user":1==a&&(u=URL_BASE+"/permisos/unidad");const m=await fetch(u,{method:"POST",headers:{token:token},body:p}),f=await m.json();console.log(f),f.exito?Swal.fire({position:"top-end",icon:"success",title:f.exito,showConfirmButton:!1,timer:1500}).then(()=>{dibujarCarpeta(e),$("#exampleModalPermisosUser").modal("hide")}):f.error?Swal.fire({icon:"error",title:"ERROR",text:f.error}).then(()=>{dibujarCarpeta(e),$("#exampleModalPermisosUser").modal("hide")}):f.exit?Swal.fire({icon:"warning",title:f.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}):(d+='<ul class="alert bg-white px-5 mt-3" style="border-radius:5px;border:1px solid red"  style="width:100%" >',f.alertas.error.forEach(e=>{d+='<li class="text-danger"  >',d+=e,d+="</li>"}),d+="</ul>",document.getElementById("alertas").innerHTML=d),alertas()}async function updateSeccion(e,t,a){var i="";const s=document.getElementById("seccion"+t).value,o=document.getElementById("descripcion"+t).value,l=document.getElementById("color"+t).value,d=document.getElementById("select"+t).value,n=new FormData;n.append("hijo",t),n.append("padre",e),n.append("seccion",s),n.append("descripcion",o),n.append("color",l),e!=d&&n.append("idPadre",d),1==a?n.append("tipo",1):n.append("tipo",2),console.log([...n]);const r=await fetch("http://localhost/gdagmcp/carpeta/update",{method:"POST",headers:{token:token},body:n}),c=await r.json();c.exito?Swal.fire({position:"top-end",icon:"success",title:c.exito,showConfirmButton:!1,timer:1500}).then(()=>{$("#exampleModal"+t).modal("hide"),$("#exampleModalEditar"+t).modal("hide"),dibujarCarpeta(t)}):c.error?Swal.fire({icon:"error",title:"ERROR",text:c.error}).then(()=>{$("#exampleModal"+t).modal("hide"),$("#exampleModalEditar"+t).modal("hide"),dibujarCarpeta(t)}):c.exit?Swal.fire({icon:"warning",title:c.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}):(console.log("alertas",c),i+='<ul class="alert bg-white px-5 mt-3" style="border-radius:5px;border:1px solid red"  style="width:100%" >',c.alertas.error.forEach(e=>{i+='<li class="text-danger"  >',i+=e,i+="</li>"}),i+="</ul>",document.getElementById("alertas"+t).innerHTML=i),alertas()}async function deleteSeccion(e){const t=await traerSeccion(e);Swal.fire({title:"ELIMINAR",text:`Estas seguro de Eliminar de forma permamente a ${t.seccion}?`,icon:"error",showCancelButton:!0,confirmButtonText:"Eliminar",confirmButtonColor:"#dc3545"}).then(a=>{a.isConfirmed&&$.ajax({data:{id:e},url:URL_BASE+"/carpeta/delete",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{console.log("response Eliminar",e),e.exito?Swal.fire({position:"top-end",icon:"success",title:e.exito,showConfirmButton:!1,timer:1500}).then(()=>{window.location.href=URL_BASE+"/permisos"}):e.error?Swal.fire({icon:"error",title:"ERROR",html:"<strong>"+e.carpeta+"</strong> "+e.error}).then(()=>{dibujarCarpeta(t.id)}):e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"})}).fail(e=>{console.log(e)})})}function userPermisosHistorial(e,t){return new Promise((a,i)=>{$.ajax({data:{tipo:"userPermisosHistorial",idUser:t,idSeccion:e},url:URL_BASE+"/user/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),a(e)}).fail(e=>{i(e)})})}function unidadPermisosHistorial(e,t){return new Promise((a,i)=>{$.ajax({data:{tipo:"unidadPermisosHistorial",idUnidad:t,idSeccion:e},url:URL_BASE+"/unidad/datos",type:"POST",headers:{token:token},dataType:"json"}).done(e=>{e.exit&&Swal.fire({icon:"warning",title:e.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),a(e)}).fail(e=>{i(e)})})}document.addEventListener("click",(function(e){document.querySelectorAll(".permiso").forEach(t=>{1==e.target.id&&e.target.classList.contains("permiso")?(t.parentNode.parentNode.parentNode.classList.remove("alertaPermiso"),cont=0,0==e.target.checked&&1!=t.id?(t.checked=!1,t.parentNode.classList.add("apagar"),4==t.id&&t.parentNode.classList.remove("apagar")):1==e.target.checked&&1!=t.id&&t.id<4&&(t.parentNode.classList.remove("apagar"),t.checked=!1)):4==e.target.id&&e.target.classList.contains("permiso")&&(0==e.target.checked?4!=t.id&&t.id>4&&(t.parentNode.classList.add("apagar"),t.checked=!1):1==e.target.checked&&4!=t.id&&t.id>4&&(t.parentNode.classList.remove("apagar"),t.checked=!1))})}));