const URL_BASE="http://localhost/gdagmcp",token=JSON.parse(localStorage.getItem("token")),CARPETA_BASE="/base";async function iniciarApp(){const a=window.location.search,e=new URLSearchParams(a);var t=e.get("id"),s=e.get("a");await dibujarPadreAndCarpetas(t),s&&mostrarAlerta()}function alertas(){const a=document.querySelectorAll(".alert"),e=document.getElementById("alertas"),t=document.querySelector("#alertaTipo");a&&setTimeout(()=>{a.forEach((function(a){a.remove(),e&&(e.innerHTML=""),t&&(t.innerHTML="")}))},3e3)}function mostrarAlerta(){Swal.fire({icon:"warning",title:"Error",showConfirmButton:!0,text:"No existen carpetas disponibles"}).then(()=>{window.location.href=URL_BASE+"/editor/carpeta?id=0"})}function traerCarpetasByUser(a){return new Promise((e,t)=>{let s=[];$.ajax({data:{tipo:"seccionByUserPermisos",id:a},url:URL_BASE+"/editor/carpeta",type:"POST",headers:{token:token},dataType:"json"}).done(a=>{a.exit&&Swal.fire({icon:"warning",title:a.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==a.length&&(console.log("secciones",s),e(s)),$.each(a,(t,i)=>{s.push(i),a.length==t+1&&e(s)})}).fail(a=>{t(a)})})}function traerPadreByUser(a){return new Promise((e,t)=>{$.ajax({data:{tipo:"padreByUserPermisos",id:a},url:URL_BASE+"/editor/carpeta",type:"POST",headers:{token:token},dataType:"json"}).done(a=>{a.exit&&Swal.fire({icon:"warning",title:a.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),e(a)}).fail(a=>{t(a)})})}function traerDocs(a){return new Promise((e,t)=>{let s=[];$.ajax({data:{id:a,tipo:"documentos"},url:URL_BASE+"/carpeta/datos",type:"POST",headers:{token:token},dataType:"json"}).done(a=>{a.exit&&Swal.fire({icon:"warning",title:a.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==a.length&&e(0),$.each(a,(t,i)=>{s.push(i),a.length==t+1&&e(s)})}).fail(a=>{t(a)})})}function traerDocumento(a){return new Promise((e,t)=>{$.ajax({data:{id:a,tipo:"documento"},url:URL_BASE+"/documento/datos",type:"POST",headers:{token:token},dataType:"json"}).done(a=>{a.exit&&Swal.fire({icon:"warning",title:a.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),0==a.length&&e(0),$.each(a,(a,t)=>{e(t)})}).fail(a=>{t(a)})})}async function dibujarPadreAndCarpetas(a){await dibujarPadre(a),await dibujarHijosPadre(a),configDocs={saveBoton:!1,mostrarAllDocs:!1,valuesInputMover:[]}}async function dibujarPath(a,e){"base"!=a?$.ajax({data:{tipo:"buscarPath",value:a.replace("_"," "),id:e},url:URL_BASE+"/editor/datos",type:"POST",headers:{token:token},dataType:"json"}).done(a=>{a.exit&&Swal.fire({icon:"warning",title:a.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),console.log("asdfasd",a)}).fail(a=>{console.log(a)}):window.location.href=URL_BASE+"/editor/carpeta?id=0"}async function dibujarPadre(a){var e="";let t,s=await traerPadreByUser(a);var i,o,l,n;if(0==s.length&&(s=void 0),null==s?t=0:(t=s.idPadre,o=(i=JSON.parse(s.permisos)).filter(a=>"carpeta"===a.type),i.filter(a=>"documento"===a.type),n=o.find(a=>3==a.id&&1==a.status),l=o.find(a=>2==a.id&&1==a.status)),e+='<div class="d-flex justify-content-center padreAtras">',e+='<div class="d-flex justify-content-center hijoAtras">',e+='<a class=" btn btn-outline-danger '+(null==s?"noVisible":"")+' " href="'+URL_BASE+"/editor/carpeta?id="+t+'"><i class="fa-solid fa-arrow-left-long fa-2x"></i> <span class="span-boton">Atrás</span></a>',e+="</div>",null==s?e+='<h1 class="text-black mb-3"><strong>Administrar Carpetas</strong></h1>':(e+='<div class="d-flex flex-column justify-content-center">',e+='<div class="d-flex justify-content-center">',e+='<h1 class="text-black mb-3"><i class="fa-solid fa-folder-open fa-xl" style="margin-right:7px;color:'+s.color+'"></i><strong>'+(s.seccion[0].toUpperCase()+s.seccion.substring(1))+"</strong></h1>",n&&(e+='<button type="button" class="btn btn-outline-secondary dropdown-toggle" data-bs-toggle="dropdown" style="margin-left:5px;margin-top:4px;width:25px;height:30px;border-radius:15px">',e+='<i class="fa-solid fa-ellipsis-vertical fa-xl "></i>',e+="</button>",e+='<ul class="dropdown-menu dropdown-menu-dark">',e+=' <li class="puntero"><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModalEditar'+s.id+'"><i class="fa-solid fa-pen-to-square" style="margin-right:7px"></i>Editar</a></li>',e+='<li class="puntero"><a class="dropdown-item" onclick="deleteSeccion('+s.id+')"><i class="fa-solid fa-trash" style="margin-right:7px"></i>Eliminar</a></li>',e+="</ul>"),e+="</div>",s.descripcion.length>0?e+='<h3 class="text-black mt-3 mb-4">'+(s.descripcion[0].toUpperCase()+s.descripcion.substring(1))+"</h3>":e+='<h3 class="text-black mt-3 mb-4">'+s.descripcion+"</h3>",e+="</div>"),e+="</div>",e+='<div class="d-flex justify-content-end mt-2">',e+='<div style="margin-right:5px" id="divBtnBuscar">',e+='<a class="btn btn-outline-primary" onclick="buscarCarpeta('+(null!=s?s.idSeccion:0)+')"><i class="fa-solid fa-magnifying-glass fa-2x"></i><span class="span-boton">Carpeta</span></a>',e+="</div>",e+="<div>",null!=s&&l&&(e+='<a class=" btn btn-primary"  data-bs-toggle="modal" data-bs-target="#exampleModalCrear'+a+'" id="'+a+'"><i class="fa-solid fa-plus fa-2x"></i><span class="span-boton">Carpeta</span></a>'),e+="</div>",e+="</div>",e+='<div class="w-100 mt-2">',console.log("paths"),null!=s){JSON.parse(s.pathLink).forEach(a=>{console.log("paths",a);var t=a.seccion.replaceAll("_"," ");e+=`<a class="puntero" style="text-decoration: none !important;" href="${URL_BASE}/editor/carpeta?id=${a.id}")"><strong>`+(t[0].toUpperCase()+t.substring(1))+"</strong></a> /  "})}if(e+="</div>",e+='<div class="contenedor-carpetas mt-3 mb-5" id="contenedorCarpetas" >',e+="</div>",l&&(e+='<div class="modal fade" id="exampleModalCrear'+a+'" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">',e+='<div class="modal-dialog">',e+='<div class="modal-content">',e+='  <div class="modal-header bg-black">',e+=null==s?'   <h5 class="modal-title text-white">Crear Carpeta</h5>':'   <h5 class="modal-title text-white">Agregar Carpeta en '+(s.seccion[0].toUpperCase()+s.seccion.substring(1))+"</h5>",e+='<button type="button" class="btn text-white" style="font-size:11px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',e+="  </div>",e+='  <div class="modal-body">',e+='<h3 class="text-black mt-2 mb-4">Ingresar Datos</h3>',e+='<div class="mb-3">',e+='<label  class="form-label"><strong>Nombre:</strong></label>',e+='<input type="text" class="form-control" id="seccion" name="seccion" placeholder="Ingrese nombre">',e+="</div>",e+='<div class="mb-2">',e+='<label  class="form-label"><strong>Descripción:</strong></label>',e+='<textarea class="form-control" rows="5" id="descripcion" placeholder="Ingrese descripción"></textarea>',e+="</div>",e+='<div class="mb-3">',e+='<label  class="form-label"><strong>Color:</strong></label>',e+='<input type="color" class="form-control w-25" id="color" name="color">',e+="</div>",e+='<div class="w-100 mt-2" id="alertas">',e+="</div>",e+="</div>",e+='<div class="modal-footer">',e+='<button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancelar</button>',e+=null==s?'<a class="btn btn-success" id="botonCrear" onclick="createSeccion(0)"><i class="fa-solid fa-floppy-disk"></i> <span style="margin-left:8px">Guardar</span></a>':'<a class="btn btn-success" id="botonCrear" onclick="createSeccion('+a+')"><i class="fa-solid fa-floppy-disk"></i> <span style="margin-left:8px">Guardar</span></a>',e+="</div>",e+="</div>",e+="</div>",e+="</div>"),void 0!==s&&n){e+='<div class="modal fade" id="exampleModalEditar'+s.id+'" tabindex="-1" aria-labelledby="exampleModalLabel'+s.id+'" aria-hidden="true">',e+='<div class="modal-dialog">',e+='<div class="modal-content">',e+='  <div class="modal-header bg-black">',e+='   <h5 class="modal-title text-white">Editar</h5>',e+='<button type="button" class="btn text-white" style="font-size:11px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',e+="  </div>",e+='  <div class="modal-body" style="min-height:350px">',e+='<h3 class="text-black mt-2 mb-4">Edite <strong>'+s.seccion+"</strong></h3>",e+='<div class="mb-4 d-flex justify-content-between">',e+='<div class="d-flex flex-column" style="width:70%">',e+='<label  class="form-label"><strong>Nombre:</strong></label>',e+='<input type="text" class="form-control" id="seccion'+s.id+'" value="'+s.seccion+'">',e+="</div>",e+='<div class="d-flex flex-column" style="width:28%">',e+='<label class="form-label"><strong>Color:</strong></label>',e+='<input type="color" class="form-control  puntero" id="color'+s.id+'" value="'+s.color+'">',e+="</div>",e+="</div>",e+='<div class="mb-4">',e+='<label for="exampleFormControlInput1" class="form-label"><strong>Descripción:</strong></label>',""==s.descripcion?e+='<textarea class="form-control" rows="6" id="descripcion'+s.id+'" placeholder="Esta Sección no tiene descripción"></textarea>':e+='<textarea class="form-control" rows="6" id="descripcion'+s.id+'" >'+s.descripcion+"</textarea>",e+="</div>",e+='<div class="mb-4">',e+='<div class="w-100">',e+='<label class="form-label"><strong>Mover Carpeta:</strong></label>',e+="</div>",e+='<div style="height:30px">',e+='<select style="width:100%;height:100% !important" id="select'+s.id+'" class="js-example-basic-single" >';const a={id:"0",idPadre:"0",seccion:"CARPETA BASE",descripcion:"",color:"#000000",path:"/base"};console.log(s);let t=JSON.parse(s.carpetas);t.unshift(a),t.forEach(a=>{a.id!=s.id&&(e+='<optgroup label="'+a.seccion+'">',e+='<option value="'+a.id+'" '+(a.id==s.idPadre?"selected":"")+'><strong><i class="fa-solid fa-folder-open"></i></strong>'+a.path+"</option>",e+="</optgroup>")}),e+="</select>",e+="</div>",e+='<div class="w-100 mt-4" id="alertas'+s.id+'">',e+="</div>",e+="</div>",e+="</div>",e+='<div class="modal-footer">',e+='<button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancelar</button>',e+='<a class="btn btn-success" id="botonCrear" onclick="updateSeccion('+s.idPadre+","+s.id+',1)"><i class="fa-solid fa-floppy-disk"></i> <span style="margin-left:8px">Guardar</span></a>',e+="</div>",e+="</div>",e+="</div>",e+="</div>"}document.getElementById("dibujar-js").innerHTML=e,document.getElementById("dibujar-tabla").innerHTML="",waitResponse("#contenedorCarpetas"),a>0&&await dibujarDocs(a),$("#select"+a).select2({dropdownParent:$("#exampleModalEditar"+a)})}async function dibujarHijosPadre(a,e=[]){let t="";var s,i;t=e.length>0?e:await traerCarpetasByUser(a);var o="";0===t.length?(o+='<div class="px-5 py-2 mt-3 w-100 ">',o+='<div class="d-flex justify-content-center align-items-center">',o+='<h4 class="" style="color:red">No Existen Carpetas</h4>',o+="</div>",o+="</div>"):(o+='<div class="d-flex justify-content-center " style="flex-wrap:wrap">',t.forEach(e=>{o+='<div class="p-3 padreCarpeta">',s=JSON.parse(e.permisos),i=s.filter(a=>"carpeta"===a.type),s.filter(a=>"documento"===a.type);let t=i.find(a=>3==a.id&&1==a.status);if(o+='<a class="btn hoverCarpeta" style="border:1px solid #e2e4e6"  href="'+URL_BASE+"/editor/carpeta?id="+e.idSeccion+'">',o+='<div class="row justify-content-center align-items-center  widthCarpeta ">',o+='<div class="">',o+='<i class="fa-regular fa-folder-open" style="font-size:40px;margin-bottom:10px;color:'+e.color+'"></i>',o+='<div style="margin-bottom:-7px">',o+='<p style="font-weight:bold">'+(e.seccion[0].toUpperCase()+e.seccion.substring(1))+"</p>",o+="</div>",o+="</div>",o+="</div>",o+="</a>",t){o+='<div class="d-flex justify-content-center align-items-center elip">',o+='<buttom class="btn btn-outline-secondary botonesCarpeta btn-hover dropdown-toggle py-2 px-3"  style="border:none" data-bs-toggle="dropdown" aria-expanded="false" type="buttom">',o+='<i class="fa-solid fa-ellipsis-vertical fa-xl elip" ></i>',o+="</buttom>",o+='<ul class="dropdown-menu dropdown-menu-dark">',o+='<li class="puntero"><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal'+e.id+'"><i class="fa-solid fa-pen-to-square" style="margin-right:7px"></i>Editar</a></li>',o+='<li class="puntero"><a class="dropdown-item" onclick="deleteSeccion('+e.id+')"><i class="fa-solid fa-trash" style="margin-right:7px"></i>Eliminar</a></li>',o+=" </ul>",o+="</div>",o+="</div>",o+='<div class="modal fade" id="exampleModal'+e.id+'" tabindex="-1" aria-labelledby="exampleModalLabel'+e.id+'" aria-hidden="true">',o+='<div class="modal-dialog">',o+='<div class="modal-content">',o+='  <div class="modal-header bg-black">',o+='   <h5 class="modal-title text-white">Editar</h5>',o+='<button type="button" class="btn text-white" style="font-size:11px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',o+="  </div>",o+='  <div class="modal-body" style="min-height:350px">',o+='<h3 class="text-black mt-2 mb-4">Edite <strong>'+e.seccion+"</strong></h3>",o+='<div class="mb-4 d-flex justify-content-between">',o+='<div class="d-flex flex-column" style="width:70%">',o+='<label  class="form-label"><strong>Nombre:</strong></label>',o+='<input type="text" class="form-control" id="seccion'+e.id+'" value="'+e.seccion+'">',o+="</div>",o+='<div class="d-flex flex-column" style="width:28%">',o+='<label class="form-label"><strong>Color:</strong></label>',o+='<input type="color" class="form-control  puntero" id="color'+e.id+'" value="'+e.color+'">',o+="</div>",o+="</div>",o+='<div class="mb-4">',o+='<label for="exampleFormControlInput1" class="form-label"><strong>Descripción:</strong></label>',""==e.descripcion?o+='<textarea class="form-control" rows="6" id="descripcion'+e.id+'" placeholder="Esta Sección no tiene descripción"></textarea>':o+='<textarea class="form-control" rows="6" id="descripcion'+e.id+'" >'+e.descripcion+"</textarea>",o+="</div>",o+='<div class="mb-4">',o+='<div class="w-100">',o+='<label class="form-label"><strong>Mover Carpeta:</strong></label>',o+="</div>",o+='<div style="height:30px">',o+='<select style="width:100%;height:100% !important" id="select'+e.id+'" class="js-example-basic-single" >';const t={id:"0",idPadre:"0",seccion:"CARPETA BASE",descripcion:"",color:"#000000",path:"/base"};let s=JSON.parse(e.carpetas);s.unshift(t),s.forEach(t=>{t.id!=e.id&&(o+='<optgroup label="'+t.seccion+'">',o+='<option value="'+t.id+'" '+(t.id==a?"selected":"")+'><strong><i class="fa-solid fa-folder-open"></i></strong>'+t.path+"</option>",o+="</optgroup>")}),o+="</select>",o+="</div>",o+='<div class="w-100 mt-4" id="alertas'+e.id+'">',o+="</div>",o+="</div>",o+="</div>",o+='<div class="modal-footer">',o+='<button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancelar</button>',o+='<a class="btn btn-success" id="botonCrear" onclick="updateSeccion('+a+","+e.id+',2)"><i class="fa-solid fa-floppy-disk"></i> <span style="margin-left:8px">Guardar</span></a>',o+="</div>",o+="</div>",o+="</div>"}o+="</div>"}),o+="</div>"),document.getElementById("contenedorCarpetas").innerHTML=o,t.forEach(a=>{$("#select"+a.id).select2({dropdownParent:$("#exampleModal"+a.id)})})}async function waitResponse(a,e="129.5px",t=1){var s="";1==t?(s+='<div class="d-flex justify-content-center align-items-center w-100" style="width:100% !important;height:'+e+'" width:100% !important;height:50px" id="contenedorWait">',s+=' <div class="spinner-grow" role="status">',s+='<span class="visually-hidden">Loading...</span>',s+="</div>",s+=' <div class="spinner-grow" role="status">',s+='<span class="visually-hidden">Loading...</span>',s+="</div>",s+=' <div class="spinner-grow" role="status">',s+='<span class="visually-hidden">Loading...</span>',s+="</div>",s+="</div>"):(a.innerHTML="",s+='<td colspan="8" valign="top">',s+='<div class="d-flex justify-content-center align-items-center w-100" style="width:100% !important;height:'+e+'" id="contenedorWait">',s+=' <div class="spinner-grow" role="status">',s+='<span class="visually-hidden">Loading...</span>',s+="</div>",s+=' <div class="spinner-grow" role="status">',s+='<span class="visually-hidden">Loading...</span>',s+="</div>",s+=' <div class="spinner-grow" role="status">',s+='<span class="visually-hidden">Loading...</span>',s+="</div>",s+="</div>",s+="</td>"),document.querySelector(a).innerHTML=s}async function dibujarDocs(a,e=[]){let t,s=await traerPadreByUser(a);t=0==e.length?await traerDocs(a):e;let i=JSON.parse(s.permisos);console.log("permiso Actual de los documentos",i);let o=i.filter(a=>"documento"===a.type),l=o.find(a=>4==a.id&&1==a.status),n=o.find(a=>5==a.id&&1==a.status),d=o.find(a=>6==a.id&&1==a.status),r=o.find(a=>7==a.id&&1==a.status),c=o.find(a=>8==a.id&&1==a.status);o.find(a=>9==a.id&&1==a.status);if(l){var p="";p+='<div class="accordion" id="accordionExample">',p+='<div class="accordion-item ">',p+='<h2 class="accordion-header" id="headingOne">',p+='<button class="accordion-button '+(t.length>0?"":"collapsed")+' contenedor-carpetas" type="button"  style="height:55px" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne"><div class="d-flex w-100 justify-content-center"><h4 style="color:black">Documentos de<strong> '+s.seccion+"</strong></h4></div></button>",p+=" </h2>",p+='<div id="collapseOne" class="accordion-collapse collapse '+(t.length>0?"show":"")+'" data-bs-parent="#accordionExample">',p+=' <div class="accordion-body px-0">',p+='<div class="" id="botonesDoc">',p+='<div class="d-flex mb-3 justify-content-end">',n&&(p+='<a title="Mover Documentos" class="btn btn-outline-primary" style="margin-right:4px" id="moverDocs"  onclick="moverDocumentos('+a+',0)"><i class="fa-solid fa-square-check fa-2x"></i></a>'),p+='<a title="Ver todos los Documentos" class="btn btn-primary" style="margin-right:4px" id="mostrarDocs"  onclick="mostrarDocsPro('+a+')"><i class="fa-regular fa-eye fa-2x"></i></a>',d&&(p+='<a class="btn btn-warning"  onclick="agregarDocumento('+a+')"><i class="fa-solid fa-plus fa-2x"></i><span class="span-boton">Documento</span></a>'),p+="</div>",p+="</div>",n&&(p+='<div class="apagar" id="botonesMover">',p+='<div class="d-flex mb-3 justify-content-end">',p+='<a title="Cancelar" class="btn btn-outline-danger" style="margin-right:4px" id="mostrarDocs"  onclick="moverDocumentos('+a+',0)"><i class="fa-solid fa-ban fa-2x"></i></a>',p+='<buttom title="Mover Seleccionados" class="btn btn-success" onclick="inputsValue('+a+')"  id="moverSelect" ><i class="fa-solid fa-folder-tree fa-2x" style="margin-right:4px"></i><span class="span-boton"> Mover a:</span></buttom>',p+="</div>",p+="</div>"),p+='<table class="table" style="min-width:1000px" id="tablaDocsUltimo">',p+='<thead class="table-dark">',p+='<tr class="" style="text-transform:uppercase">',p+="<th>N°</th>",p+='<th class="col-2">Nombre</th>',p+='<th class="">Carpeta</th>',p+='<th class="">Form</th>',p+='<th class="col-1">Datos</th>',p+='<th class="">Responsable</th>',p+='<th class="col-1">Fecha</th>',p+='<th class="col">Acciones</th>',p+="</tr>",p+="</thead>",p+='<tbody class="contenido" id="contenido">',t.length>0&&t.forEach((a,e)=>{p+="<tr>",p+="<td>"+(parseInt(e)+1)+"</td>",""==a.alias?p+="<td>"+a.codigo+"</td>":p+="<td>"+a.alias+"</td>",p+="<td>"+a.seccion+"</td>",p+="<td>"+a.formulario+"</td>",p+='<td><buttom class="btn btn-secondary" style="margin-left:12px" data-bs-toggle="modal" data-bs-target="#exampleModalVer'+a.id+'">Ver</buttom></td>',p+="<td>"+a.responsable+"</td>",p+='<td><div class="row"  style="font-size:14px"><p>'+a.created_at.split(" ")[0]+"</p><p>"+a.created_at.split(" ")[1]+"</p></div></td>",p+="<td >",p+=' <div class="contenedor-opciones">',p+='<div class="d-flex justify-content-center">';const t="'"+a.path+"'",s="'"+a.codigo+"'";p+='<buttom title="Ver Documento" class="btn btn-outline-primary" style="margin-right:5px;height:30px;width:32px" onclick="abrirPdf('+t+","+s+')"><i class="fa-solid fa-file-pdf fa-2x"></i></buttom>',r&&(p+='<buttom title="Editar" class="btn btn-warning"  data-bs-toggle="modal" data-bs-target="#exampleModalEditar'+a.id+'" style="margin-right:5px;height:30px;width:32px"><i class="fa-solid fa-pen-to-square fa-2x"></i></i></buttom>'),c&&(p+='<buttom title="Eliminar" class="btn btn-outline-danger" style=";height:30px;width:32px" onclick="deleteDoc('+a.id+')"><i class="fa-solid fa-trash fa-2x"></i></buttom>'),p+="</div>",p+="</div>",n&&(p+='<div class="apagar  contenedor-check">',p+='<div class=" d-flex justify-content-center">',p+='<input class="form-check-input mover" style="margin:0px;margin-left:15px;width:30px;height:30px;border:2px solid #0D6EFD" type="checkbox" value='+a.id+">",p+="</div>",p+="</div>"),p+="</td>",p+="</tr>",p+='<div class="modal fade" id="exampleModalVer'+a.id+'" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">',p+=' <div class="modal-dialog modal-dialog-centered">',p+=' <div class="modal-content">',p+=' <div class="modal-header bg-black ">',p+=' <h5 class="modal-title text-white" id="exampleModalLabel">Metadatos Documento <strong>'+a.codigo+"</strong></h5>",p+='<button type="button" class="btn text-white" style="font-size:13px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',p+=" </div>",p+='  <div class="modal-body">';let i=JSON.parse(a.data);if(p+='<ol class="list-group list-group-numbered" style="font-size:12px">',p+='<li class="list-group-item  d-flex justify-content-between align-items-start">',p+='<div class="ms-2 me-auto">',p+=' <div class="fw-bold mb-2">KEYWORDS</div>',p+=a.keywords,p+=" </div>",p+="</li>",i.forEach(a=>{p+='<li class="list-group-item  d-flex justify-content-between align-items-start">',p+='<div class="ms-2 me-auto">',p+=' <div class="fw-bold mb-2">'+a.nombre.toUpperCase()+"</div>",p+=a.valor,p+=" </div>"}),p+="</ol>",p+="</div>",p+=' <div class="modal-footer d-flex justify-content-between mt-3">',p+=' <p class=""> Ultima modificación: <strong>'+a.updated_at+"</strong></p>",p+=' <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cerrar</button>',p+="  </div>",p+="</div>",p+="</div>",p+="</div>",r){p+='<div class="modal fade" id="exampleModalEditar'+a.id+'" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">',p+=' <div class="modal-dialog modal-dialog-centered">',p+=' <div class="modal-content">',p+=' <div class="modal-header bg-black ">',p+=' <h5 class="modal-title text-white" id="exampleModalLabel">Editar Metadatos <strong>'+a.codigo+"</strong></h5>",p+='<button type="button" class="btn text-white" style="font-size:13px" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-x fa-lg"></i></button>',p+=" </div>",p+='  <div class="modal-body">';let e=JSON.parse(a.data);p+='<div class="mb-4" id="keywords">',p+='<label class="form-label"><strong>KEYWORDS</strong></label>',p+='<textarea class="form-control edit-campos'+a.id+'" rows="3" name="keywords" placeholder="Documento sin palabras claves">'+a.keywords+"</textarea>",p+="</div>",e.forEach(e=>{p+='<div class="mb-4" id="'+e.nombre.trim()+'">',p+='<label class="form-label"><strong>'+e.nombre.toUpperCase()+"</strong></label>",p+='<textarea class="form-control edit-campos'+a.id+'"  rows="4" name="'+e.nombre.trim()+'" placeholder="Sin datos">'+e.valor+"</textarea>",p+="</div>"}),p+='<div class="mb-4" id="alias">',p+='<label class="form-label"><strong>ALIAS</strong></label>',p+='<textarea class="form-control '+a.id+'" rows="2" name="alias" placeholder="Documento sin alias">'+a.alias+"</textarea>",p+="</div>",p+='<div class="w-100 mt-2" id="alertasEditarMetadata'+a.id+'">',p+="</div>",p+="</div>",p+='<div class="modal-footer mt-3 d-flex justify-content-between">',p+='<p class=""> Ultima modificación: <strong>'+a.updated_at+"</strong></p>",p+='<div class="">',p+='<button type="button" style="margin-right:4px" class="btn btn-outline-danger" data-bs-dismiss="modal">Cerrar</button>',p+='<button type="button" class="btn btn-success" onclick="saveEditDoc('+a.id+')"><i class="fa-solid fa-floppy-disk" style="margin-right:3px"></i>Guardar</button>',p+="</div>",p+="</div>",p+="</div>",p+="</div>",p+="</div>"}}),p+="</tbody>",p+="</table>",p+="</tbody>",p+=" </div>",p+=" </div>",p+="</div>",p+="</div>",document.getElementById("dibujar-tabla").innerHTML=p,0!==e.length&&document.getElementById("mostrarDocs").classList.add("disabledButtom"),$("#tablaDocsUltimo").DataTable({language:{url:URL_BASE+"/public/build/js/varios/DataTable_es_es.json"}})}}function buscarCarpeta(a){document.getElementById("divBtnBuscar").innerHTML="",console.log("seecionActual",a);var e="";e+='<div class=" d-flex  justify-content-end" >',e+='<input style="width:193.5px;height:32.3px" class="form-control" id="buscarFocus" type="text" placeholder="Ingrese nombre de carpeta" onKeyUp="escucharCarpeta(this.value,'+(null!=a?a:0)+')">',e+="</div>",document.getElementById("divBtnBuscar").innerHTML=e,document.getElementById("buscarFocus").focus()}async function createSeccion(a=0){var e="";const t=document.getElementById("seccion").value,s=document.getElementById("descripcion").value,i=document.getElementById("color").value;hexToRgb(i);const o=new FormData;o.append("idPadre",a),o.append("seccion",t),o.append("descripcion",s),o.append("color",i),console.log([...o]);const l=await fetch("http://localhost/gdagmcp/editor/carpeta/create",{method:"POST",headers:{token:token},body:o}),n=await l.json();n.exito?Swal.fire({position:"top-end",icon:"success",title:n.exito,showConfirmButton:!1,timer:1500}).then(()=>{$("#exampleModalCrear"+a).modal("hide"),dibujarPadreAndCarpetas(a)}):n.error?Swal.fire({icon:"error",title:"ERROR",text:n.error}).then(()=>{$("#exampleModalCrear"+a).modal("hide"),dibujarPadreAndCarpetas(a)}):n.exit?Swal.fire({icon:"warning",title:n.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}):(e+='<ul class="alert bg-white px-5 mt-3" style="border-radius:5px;border:1px solid red"  style="width:100%" >',n.alertas.error.forEach(a=>{e+='<li class="text-danger"  >',e+=a,e+="</li>"}),e+="</ul>",document.getElementById("alertas").innerHTML=e),alertas()}function hexToRgb(a){const e=a.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);if(e)return e.slice(1).map(a=>parseInt(a,16));const t=a.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i);return t?t.slice(1).map(a=>17*parseInt(a,16)):0}document.addEventListener("DOMContentLoaded",iniciarApp()),escucharCarpeta=(a,e)=>{var t="";$.ajax({data:{tipo:"buscarCarpetas",value:a,id:e},url:URL_BASE+"/editor/datos",type:"POST",headers:{token:token},dataType:"json"}).done(a=>{a.exit&&Swal.fire({icon:"warning",title:a.exit,showConfirmButton:!1,text:"Sesión expirada, vuelva a iniciar sesión",timer:3e3}).then(()=>{window.location.href=URL_BASE+"/?r=8"}),console.log("desponseeee",a),0!=a.length?dibujarHijosPadre(e,a):(t+='<div class="px-5 py-2 mt-3 w-100 ">',t+='<div class="d-flex justify-content-center align-items-center">',t+='<h4 class="" style="color:red">No Existen Carpetas</h4>',t+="</div>",t+="</div>",document.getElementById("contenedorCarpetas").innerHTML=t)}).fail(a=>{console.log(a)})};